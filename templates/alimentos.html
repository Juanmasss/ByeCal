<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>ByeCal</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styleali.css') }}">
    <link rel="icon" href="{{ url_for('static', filename='ByeCal.ico') }}">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body>
    <!-- Caja verde MÁS GRANDE -->
    <div class="container"
         style="
            max-width: 980px;
            margin: 40px auto;
            padding: 24px 28px;
            border-radius: 12px;
         ">

        <h1 style="margin-top:0;">Buscar alimento</h1>

        <form method="POST" action="{{ url_for('alimentos') }}" style="margin-bottom: 14px;">
            <label for="nombre">Nombre del alimento:</label>
            <input type="text" id="nombre" name="nombre" required style="width:100%; max-width: 620px;">
            <button type="submit"
                    style="display:block; margin-top:10px; padding:10px 20px; border:none; border-radius:8px; font-weight:600; cursor:pointer;">
                Buscar
            </button>
        </form>

        {% if info %}
        <div class="resultado" style="margin-top: 16px;">
            <h2>Información Nutricional</h2>

            <div class="info-contenedor" style="display:flex; gap:16px; align-items:flex-start; flex-wrap:wrap;">
                <div class="texto" style="min-width:260px;">
                    <ul>
                        <li><strong>Nombre:</strong> {{ info.nombre }}</li>
                        <li><strong>Calorías:</strong> {{ info.calorias }} kcal</li>
                        <li><strong>Proteínas:</strong> {{ info.proteinas }} g</li>
                        <li><strong>Grasas:</strong> {{ info.grasas }} g</li>
                        <li><strong>Carbohidratos:</strong> {{ info.carbohidratos }} g</li>
                    </ul>
                </div>

                {% if info.imagen %}
                <div class="imagen" style="flex:0 0 auto;">
                    <img src="{{ info.imagen }}" alt="Imagen {{ info.nombre }}" style="max-height:140px; border-radius:8px;">
                </div>
                {% endif %}
            </div>
        </div>
        {% endif %}

        <h2 style="margin-top:24px;">Historial reciente</h2>

        <div style="overflow-x:auto;">
            <table style="width:100%; border-collapse: collapse; min-width:700px;">
                <thead>
                    <tr>
                        <th style="text-align:left; padding:10px; border-bottom:1px solid rgba(255,255,255,.25);">Nombre</th>
                        <th style="text-align:left; padding:10px; border-bottom:1px solid rgba(255,255,255,.25);">Calorías</th>
                        <th style="text-align:left; padding:10px; border-bottom:1px solid rgba(255,255,255,.25);">Proteínas</th>
                        <th style="text-align:left; padding:10px; border-bottom:1px solid rgba(255,255,255,.25);">Grasas</th>
                        <th style="text-align:left; padding:10px; border-bottom:1px solid rgba(255,255,255,.25);">Carbohidratos</th>
                        <th style="text-align:left; padding:10px; border-bottom:1px solid rgba(255,255,255,.25); width:1%;">Agregar</th>
                    </tr>
                </thead>
                <tbody>
                    {% for alimento in historial %}
                    <tr>
                        <td style="padding:10px; border-bottom:1px solid rgba(0,0,0,.08);">{{ alimento.nombre }}</td>
                        <td style="padding:10px; border-bottom:1px solid rgba(0,0,0,.08);">{{ alimento.calorias }}</td>
                        <td style="padding:10px; border-bottom:1px solid rgba(0,0,0,.08);">{{ alimento.proteinas }}</td>
                        <td style="padding:10px; border-bottom:1px solid rgba(0,0,0,.08);">{{ alimento.grasas }}</td>
                        <td style="padding:10px; border-bottom:1px solid rgba(0,0,0,.08);">{{ alimento.carbohidratos }}</td>

                        <!-- Botón rojo CORRECTO dentro de su form -->
                        <td style="padding:10px; border-bottom:1px solid rgba(0,0,0,.08);">
                            <form method="POST" action="{{ url_for('agregar_consumo') }}" style="margin:0;">
                                <input type="hidden" name="alimento_id" value="{{ alimento.id }}">
                                <button type="submit"
                                        title="Agregar este alimento"
                                        style="
                                            padding:6px 10px;
                                            border:none;
                                            border-radius:8px;
                                            font-size:13px;
                                            font-weight:700;
                                            cursor:pointer;
                                            background:#d32f2f;
                                            color:#fff;
                                            box-shadow: 0 2px 6px rgba(0,0,0,.15);
                                            white-space:nowrap;">
                                    Agregar alimento
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}

                    {% if historial|length == 0 %}
                    <tr>
                        <td colspan="6" style="padding:14px; text-align:center; opacity:.8;">Sin registros recientes.</td>
                    </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>

        <div style="margin-top: 14px;">
            <a class="link" href="{{ url_for('calculadora') }}">Volver a calculadora</a>
            <span style="opacity:.35;"> &nbsp;•&nbsp; </span>
            <a class="link" href="{{ url_for('dashboard') }}">Volver al inicio</a>
            <span style="opacity:.35;"> &nbsp;•&nbsp; </span>
            <a class="link" href="{{ url_for('agregar_alimentos') }}">Ver alimentos consumidos</a>
        </div>

    </div>
</body>
</html>
